#!/bin/bash
set -eu

if [[ ${HOOK_SHOULD_FAIL:-no} = "yes" ]]; then
  exit 1
fi

if [[ ${HOOK_SHOULD_CREATE_ENV_FILE:-yes} = "no" ]]; then
  exit 0
fi

root=$1
env=$2
prefix=$3

cat >$root/$env.yml <<EOF
---
# generated by hooks/new
kit:
  name:    $GENESIS_KIT_NAME
  version: $GENESIS_KIT_VERSION
  features: []

params:
  GENESIS_KIT_NAME: $GENESIS_KIT_NAME
  GENESIS_KIT_VERSION: $GENESIS_KIT_VERSION
  GENESIS_ROOT: $GENESIS_ROOT
  GENESIS_ENVIRONMENT: $GENESIS_ENVIRONMENT
  GENESIS_VAULT_PREFIX: $GENESIS_VAULT_PREFIX

  root: $root
  env: $env
  prefix: $prefix
  extra: ${4:-(none)}
EOF
exit 0;
